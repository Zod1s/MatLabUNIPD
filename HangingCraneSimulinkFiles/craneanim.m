function [sys,x0]=craneanim(t,x,u,flag,ts);global PendAnim1 if flag==2,  if any(get(0,'Children')==PendAnim1),    if strcmp(get(PendAnim1,'Name'),'Hanging Crane Animation'),      set(0,'currentfigure',PendAnim1);      hndlList=get(gca,'UserData');      x=[u(1) u(1)+10*sin(u(2))];      y=[0 -10*cos(u(2))];      set(hndlList(1),'XData',x,'YData',y);      set(hndlList(2),'XData',u(1),'YData',0);	  set(hndlList(3),'XData',[u(1)-2, u(1)+2],'YData',[0 0]);	  set(hndlList(4),'XData',[u(1)-2, u(1)+2],'YData',[2 2]);	  set(hndlList(5),'XData',[u(1)-2, u(1)-2],'YData',[0 2]);	  set(hndlList(6),'XData',[u(1)+2, u(1)+2],'YData',[0 2]);      set(hndlList(7),'XData',[-50 50],'YData',[2.5 2.5]);	  set(hndlList(8),'XData',x(2),'YData',y(2));	  set(hndlList(9),'XData',u(1)-1,'YData',4);	  set(hndlList(10),'XData',u(1)+1,'YData',4);      drawnow;    end  end  sys=[];elseif flag == 4 % Return next sample hit    % ns stores the number of samples  ns = t/ts;  % This is the time of the next sample hit.  sys = (1 + floor(ns + 1e-13*(1+ns)))*ts;elseif flag==0,  % Initialize the figure for use with this simulation  %animinit('hanging crane Animation');  %[flag,PendAnim1] = figflag('hanging crane Animation');  PendAnim1 = figure('Name', 'Hanging Crane Animation', 'NumberTitle', 'off');  axis([-20 50 -20 5]);  hold on;  x=[0 0];  y=[0 -10];  hndlList(1)=plot(x,y,'LineWidth',5,'EraseMode','background');  hndlList(2)=plot(0,0,'.','MarkerSize',25);  hndlList(3)=plot([-2 2],[0 0],'y','LineWidth',3,'EraseMode','background');  hndlList(4)=plot([-2 2],[2 2],'y','LineWidth',3,'EraseMode','background');  hndlList(5)=plot([-2 -2],[0 2],'y','LineWidth',3,'EraseMode','background');  hndlList(6)=plot([2 2],[0 2],'y','LineWidth',3,'EraseMode','background');  hndlList(7)=plot([-50 50],[2.5 2.5],'r','LineWidth',3,'EraseMode','back');  hndlList(8)=plot(0,-10,'ko','MarkerSize',25,'EraseMode','back');  hndlList(9)=plot(-1,4,'ko','MarkerSize',8,'EraseMode','back');  hndlList(10)=plot(1,4,'ko','MarkerSize',8,'EraseMode','back');  set(gca,'DataAspectRatio',[1 1 1]);  set(gca,'UserData',hndlList);  sys=[0 0 0 2 0 0];  x0=[];end